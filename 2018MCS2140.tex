\documentclass[10pt]{article}\usepackage{graphicx}\usepackage{listings}\addtolength{\oddsidemargin}{-.875in}	\addtolength{\evensidemargin}{-.875in}	\addtolength{\textwidth}{1.75in}	\addtolength{\topmargin}{-.875in}	\addtolength{\textheight}{1.75in}\renewcommand{\baselinestretch}{0.97}\title{Assignment 1}\author {Nitish Raj, 2018MCS2140}\date{Due date: January 14, 2019, 11:55pm IST}\begin{document}\maketitle\section{Answer 1}\subsection{ER Diagram}\begin{figure}[h]\includegraphics[width=8cm]{1.jpg}\end{figure}\subsection{Set of relations}\begin{figure}[h]\includegraphics[width=4cm]{2b.jpg}\end{figure}%%% Fill in your content here.\subsection{Keys and FDs}\begin{figure}[h]\includegraphics[width=4cm]{2.jpg}\end{figure}\subsection{Sample Data}\begin{figure}[h]\includegraphics[width=8cm]{3.jpg}\end{figure}\subsection{List of various relationships}1. Manages \newline2. Controls \newline3. Makes \newline4. Joins \newline5. Ask for \newline\section{Answer 2}%%% Fill in your content here.\section{Answer 3}\subsection{Schema} I have used barcelona data sets. I  have created schema called barcelona\_data\_sets using following command. \newline\newline\textbf{ CREATE SCHEMA barcelona\_data\_sets;}\newline\newlineFurthermore, Table immigrants\_by\_nationality is created using following command.\newline\newline\textbf{CREATE TABLE barcelona\_data\_sets.immigrants\_by\_nationality(year smallint,DistrictCode smallint, DistrictName VARCHAR(50),NeighborhoodCode smallint, NeighborhoodName VARCHAR(50), Nationality TEXT, Number smallint ); }\subsection{Various insert modes}%%% Fill in your content here.\subsubsection{Bulk Load}Bulk Load is done using following command\newline\newline \textbf{ COPY barcelona\_data\_sets.immigrants\_by\_nationality FROM 'D: \textbackslash Study \textbackslash IITD IInd Semester \textbackslash COL 632 \textbackslash barcelona-data-sets \textbackslash immigrants\_by\_nationality.csv' with CSV HEADER;\newline \newline Terminal o/p\newline COPY 70448\newline Time: 594.143 ms}\subsubsection{Insert statements}\begin{lstlisting}[frame=single]package csvToSql;import java.io.*;public class csvToSqlConverter {	public static void main (String s[]) throws IOException	{		File ipFile = new File("immigrants_by_nationality.csv");		File opFile = new File("immigrants_by_nationality.sql");				try {		Convert(ipFile,opFile);		}		finally		{}					}		public static void Convert(File source , File dest) throws IOException	{		BufferedReader in = new BufferedReader(new FileReader(source));		Writer out = new BufferedWriter(new FileWriter(dest));		String tuple = null;		String[] myString = null;			                                 in.readLine(); // for schema head mentioned in datasets            		while ((tuple = in.readLine()) != null )		{						  myString = tuple.replace("\'","\'\'").split(",");		  out.write("INSERT INTO barcelona_data_sets.immigrants                 _by_nationality VALUES(" + myString[0] + "," + myString[1] +                 ",\'" + myString[2] + "\'," + myString[3] + ",\'" + myString[4]                  + "\',\'" + myString[5] + "\'," + myString[6] +" );\n");		}		in.close();		out.close();			}}\end{lstlisting}\subsubsection{using JDBC}BULK MODE USING JDBC CONNECTION \begin{lstlisting}[frame=single]import java.io.*;import java.sql.*;public class bulkJdbcInsert {    public static void main (String s[]) throws IOException, ClassNotFoundException	, SQLException	{		try {		bulkInsertJDBC();		}		finally		{}					}	    public static void bulkInsertJDBC() throws IOException, ClassNotFoundException	, SQLException	{				  Class.forName("org.postgresql.Driver");	  Connection connection = DriverManager.getConnection("	 jdbc:postgresql://127.0.0.1:5432/dbmsAssignment_db", "postgres","1234");			                        connection.createStatement().executeUpdate("COPY barcelona_data_sets.	immigrants_by_nationality FROM 'D:\\Study\\IITD IInd Semester\\COL 632	\\barcelona-data-sets\\immigrants_by_nationality.csv' with CSV HEADER;");						}}PER TUPLE INSERTION USING JDBC CONNECTIONimport java.io.*;import java.sql.*;public class singleJDBCInsert {	public static void main (String s[]) throws IOException, ClassNotFoundException,          SQLException	{		File ipFile = new File("immigrants_by_nationality.csv");				try {		singleInsertJDBC(ipFile);		}		finally		{}					}		public static void singleInsertJDBC(File source) throws IOException,            ClassNotFoundException, SQLException	{		BufferedReader in = new BufferedReader(new FileReader(source) );						Class.forName("org.postgresql.Driver");			Connection connection = DriverManager.getConnection("jdbc                                :postgresql://127.0.0.1:5432/dbmsAssignment_db", "postgres","1234");		 							String tuple = null;			String[] myString = null;			                        in.readLine(); // for schema head mentioned in datasets            			while ((tuple = in.readLine()) != null )			{				Statement stmt;								myString = tuple.replace("\'","\'\'").split(",");												connection.createStatement().executeUpdate("INSERT INTO                barcelona_data_sets.immigrants_by_nationality VALUES(\" + myString[0] + \",\" +              myString[1] + \",\\'\" + myString[2] + \"\\',\" + myString[3] + \",\\'\" + myString[4] +               \"\\',\\'\" + myString[5] \r\n" + \"\\',\" + myString[6] +\" );\\n");			}			            						}}\end{lstlisting}\subsection{Statistics}Processor : Intel Core i7 8th Gen \newline Memory :8 GB RAM \newline BulkLoad for three data sets of Barcelona is 300 ms \newline .SQL took 4 sec \newline JDBC-Bulk 1 sec \newline JDBC-Single 9 min \newline\section{Answer 4}Barcelona data is copied multiple times and created more than 5GB file.\newlineBulkLoad taking 15 minute\newline\.sql more than 1 day\newlineJDBC- bulk : 16 minute around\newlineJDBC single : more than a day\newline\end{document}